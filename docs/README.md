# FoodBot

Telegram-–±–æ—Ç —Å –ò–ò, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å –µ–¥—É, –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å –±–ª—é–¥–∞ –∏ —Å–æ—á–µ—Ç–∞–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤. –•—Ä–∞–Ω–∏—Ç –∏—Å—Ç–æ—Ä–∏—é –¥–∏–∞–ª–æ–≥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ Redis —á–µ—Ä–µ–∑ FSM.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ö–æ–º–∞–Ω–¥—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

* ‚Äú–ò–ò‚Äù ‚Äî –∑–∞–ø—É—Å–∫ —Ä–µ–∂–∏–º–∞ –æ–±—â–µ–Ω–∏—è —Å –±–æ—Ç–æ–º –ø–æ –µ–¥–µ.
* `/info` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.
* `/del_my_info` ‚Äî —É–¥–∞–ª–∏—Ç—å —Å–≤–æ—é –∏—Å—Ç–æ—Ä–∏—é.

### –ö–æ–º–∞–Ω–¥—ã –∞–¥–º–∏–Ω–∞

* `/get_all_key` ‚Äî –≤—Å–µ –∫–ª—é—á–∏ Redis.
* `/get_info_id` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –ø–æ ID.
* `/del_info_id` ‚Äî —É–¥–∞–ª–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–æ ID.
* `/cls` ‚Äî –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å—é –ë–î.

## –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

* Python, Aiogram 3
* Redis + aiogram-fsm-storage-redis
* LangChain + FAISS
* LLaMA 3.1 (—á–µ—Ä–µ–∑ localhost)
* –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è Telegram –±–æ—Ç–æ–≤.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
food-combo-bot/
‚îÇ
‚îú‚îÄ‚îÄ main.py
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ pyproject.toml
‚îÇ   ‚îî‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ knowledge_base/
‚îÇ   ‚îú‚îÄ‚îÄ cuisine/
‚îÇ   ‚îú‚îÄ‚îÄ dishes/
‚îÇ   ‚îú‚îÄ‚îÄ meal_time/
‚îÇ   ‚îú‚îÄ‚îÄ situation/
‚îÇ   ‚îú‚îÄ‚îÄ taste/
‚îÇ   ‚îî‚îÄ‚îÄ weather/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ai.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ handlers.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hendlers.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ keyboards.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ states.py
‚îÇ   ‚îî‚îÄ‚îÄ storage/
‚îÇ       ‚îú‚îÄ‚îÄ utils/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ log_user_action.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ logger.py
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ prompt.py
```


## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–æ—Ç (–ø—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞)

–ù–∏–∂–µ –æ–ø–∏—Å–∞–Ω –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã Telegram-–±–æ—Ç–∞ –ø–æ –≤—ã–±–æ—Ä—É –µ–¥—ã

---

### –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞

#### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –±–æ—Ç—É:

```text
–ß—Ç–æ –º–Ω–µ —Å—ä–µ—Å—Ç—å –Ω–∞ –æ–±–µ–¥
```

---

#### –ë–æ—Ç:

–ü–µ—Ä–µ–¥–∞—ë—Ç –∑–∞–ø—Ä–æ—Å –≤ **RAG-–º–æ–¥—É–ª—å**.

---

#### RAG-–º–æ–¥—É–ª—å:

* –í–µ–∫—Ç–æ—Ä–∏–∑—É–µ—Ç –∑–∞–ø—Ä–æ—Å (—ç–º–±–µ–¥–¥–∏–Ω–≥ –¥–ª—è: `"–ß—Ç–æ –º–Ω–µ —Å—ä–µ—Å—Ç—å –Ω–∞ –æ–±–µ–¥"`).
* –ò—â–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –∑–∞–ø–∏—Å–∏ –≤ Redis (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Ñ–∞–π–ª–µ `lunch.txt`).
* –ù–∞—Ö–æ–¥–∏—Ç –±–ª—é–¥–∞:

  * **–°—ç–Ω–¥–≤–∏—á–∏ —Å –∫—É—Ä–∏—Ü–µ–π** ‚Äî —Å—ã—Ç–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è –æ–±–µ–¥–∞.
  * **–û–≤–æ—â–Ω—ã–µ —Ä–æ–ª–ª—ã** ‚Äî –ª—ë–≥–∫–∏–π –∏ —Å–≤–µ–∂–∏–π –≤–∞—Ä–∏–∞–Ω—Ç.
* –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (FSM, Redis).

---

#### –ò–ò-–º–æ–¥–µ–ª—å:

–ü–æ–ª—É—á–∞–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π **prompt**:

```text
–¢—ã ‚Äî –∫—É–ª–∏–Ω–∞—Ä–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫.
...
–ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞:
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –ß—Ç–æ –º–Ω–µ —Å—ä–µ—Å—Ç—å –Ω–∞ –æ–±–µ–¥?

–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π:
1. –°—ç–Ω–¥–≤–∏—á–∏ —Å –∫—É—Ä–∏—Ü–µ–π ‚Äî —Å—ã—Ç–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è –æ–±–µ–¥–∞.
2. –û–≤–æ—â–Ω—ã–µ —Ä–æ–ª–ª—ã ‚Äî –ª—ë–≥–∫–∏–π –∏ —Å–≤–µ–∂–∏–π –≤–∞—Ä–∏–∞–Ω—Ç.

–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
–ß—Ç–æ –º–Ω–µ —Å—ä–µ—Å—Ç—å –Ω–∞ –æ–±–µ–¥?
```

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç:

```text
–ù–∞ –æ–±–µ–¥ –º–æ–≥—É –ø–æ—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å:

**1) –°—ç–Ω–¥–≤–∏—á–∏ —Å –∫—É—Ä–∏—Ü–µ–π** ‚Äî —Å—ã—Ç–Ω—ã–π –∏ –±—ã—Å—Ç—Ä—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Å –∫—É—Ä–∏–Ω–æ–π –≥—Ä—É–¥–∫–æ–π, —Å–∞–ª–∞—Ç–æ–º –∏ —Ö–ª–µ–±–æ–º.

**2) –û–≤–æ—â–Ω—ã–µ —Ä–æ–ª–ª—ã** ‚Äî –ª—ë–≥–∫–∏–µ –∏ —Å–≤–µ–∂–∏–µ, —Å –º–æ—Ä–∫–æ–≤—å—é, –æ–≥—É—Ä—Ü–æ–º –∏ —Ä–∏—Å–æ–≤–æ–π –±—É–º–∞–≥–æ–π.
```

---

#### –ë–æ—Ç:

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ–≥–æ –≤ –∏—Å—Ç–æ—Ä–∏–∏:

```text
–ù–∞ –æ–±–µ–¥ –º–æ–≥—É –ø–æ—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å:

**1) –°—ç–Ω–¥–≤–∏—á–∏ —Å –∫—É—Ä–∏—Ü–µ–π** ‚Äî —Å—ã—Ç–Ω—ã–π –∏ –±—ã—Å—Ç—Ä—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Å –∫—É—Ä–∏–Ω–æ–π –≥—Ä—É–¥–∫–æ–π, —Å–∞–ª–∞—Ç–æ–º –∏ —Ö–ª–µ–±–æ–º.

**2) –û–≤–æ—â–Ω—ã–µ —Ä–æ–ª–ª—ã** ‚Äî –ª—ë–≥–∫–∏–µ –∏ —Å–≤–µ–∂–∏–µ, —Å –º–æ—Ä–∫–æ–≤—å—é, –æ–≥—É—Ä—Ü–æ–º –∏ —Ä–∏—Å–æ–≤–æ–π –±—É–º–∞–≥–æ–π.
```


## –ó–∞–ø—É—Å–∫


### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

#### 0. –£—Ç–∞–Ω–æ–≤–∫–∞ env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ñ–∞–π–ª .env –∏ –ø–æ–¥—Å—Ç–∞–≤—Ç–µ —Å–≤–æ–∏ –∑–Ω–∞—á–∞–Ω–∏—è


#### 1. –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É —Å –ø—Ä–æ–µ–∫—Ç–æ–º –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–º–∞–Ω–¥—É:
```bash
docker build -t my_project .
```

#### 2. –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
```bash
docker run my_project
```

## üìä –°—Ö–µ–º–∞ –¥–≤–∏–∂–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

![–°—Ö–µ–º–∞ –¥–≤–∏–∂–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏](docs/schema_data_flow.png)

## ‚öôÔ∏è –°—Ö–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

![–°—Ö–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤](docs/schema_components.png)



## –ê–≤—Ç–æ—Ä

**–ò–≤–∞–Ω –°–µ–º–µ–Ω–∫–∏–Ω**  
[isemenkin@gmail.com](mailto:isemenkin@gmail.com)

[GitHub](https://github.com/IvanSemenkin)


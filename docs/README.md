# FoodBot

Telegram-бот с ИИ, который помогает выбирать еду, предлагать блюда и сочетания продуктов. Хранит историю диалогов пользователей в Redis через FSM.

## Возможности

### Команды пользователя

* “ИИ” — запуск режима общения с ботом по еде.
* `/info` — история последних сообщений.
* `/del_my_info` — удалить свою историю.

### Команды админа

* `/get_all_key` — все ключи Redis.
* `/get_info_id` — история по ID.
* `/del_info_id` — удалить историю по ID.
* `/cls` — очистить всю БД.

## Используемые технологии

* Python, Aiogram 3
* Redis + aiogram-fsm-storage-redis
* LangChain + FAISS
* LLaMA 3.1 (через localhost)
* Асинхронный фреймворк для создания Telegram ботов.

## Структура проекта

```bash
food-combo-bot/
│
├── main.py
├── docs/
│   ├── pyproject.toml
│   └── README.md
├── knowledge_base/
│   ├── cuisine/
│   ├── dishes/
│   ├── meal_time/
│   ├── situation/
│   ├── taste/
│   └── weather/
├── src/
│   ├── bot/
│   │   ├── ai.py
│   │   ├── handlers.py
│   │   ├── hendlers.py
│   │   ├── keyboards.py
│   │   └── states.py
│   └── storage/
│       ├── utils/
│       │   ├── log_user_action.py
│       │   ├── logger.py
│       │   └── prompt.py
```


## Как работает бот (пример полного цикла)

Ниже описан полный цикл работы Telegram-бота по выбору еды

---

### Пример полного цикла

#### Пользователь:

Отправляет боту:

```text
Что мне съесть на обед
```

---

#### Бот:

Передаёт запрос в **RAG-модуль**.

---

#### RAG-модуль:

* Векторизует запрос (эмбеддинг для: `"Что мне съесть на обед"`).
* Ищет подходящие записи в Redis (например, в файле `lunch.txt`).
* Находит блюда:

  * **Сэндвичи с курицей** — сытный вариант для обеда.
  * **Овощные роллы** — лёгкий и свежий вариант.
* Извлекает историю общения пользователя (FSM, Redis).

---

#### ИИ-модель:

Получает сгенерированный **prompt**:

```text
Ты — кулинарный помощник.
...
История диалога:
Пользователь: Что мне съесть на обед?

База знаний:
1. Сэндвичи с курицей — сытный вариант для обеда.
2. Овощные роллы — лёгкий и свежий вариант.

Сообщение пользователя:
Что мне съесть на обед?
```

Генерирует ответ:

```text
На обед могу порекомендовать:

**1) Сэндвичи с курицей** — сытный и быстрый вариант с куриной грудкой, салатом и хлебом.

**2) Овощные роллы** — лёгкие и свежие, с морковью, огурцом и рисовой бумагой.
```

---

#### Бот:

Отправляет ответ пользователю, сохраняет его в истории:

```text
На обед могу порекомендовать:

**1) Сэндвичи с курицей** — сытный и быстрый вариант с куриной грудкой, салатом и хлебом.

**2) Овощные роллы** — лёгкие и свежие, с морковью, огурцом и рисовой бумагой.
```


## Запуск

#### 1. Запустить Redis

```bash
redis-cli 
```
#### 3. Установить зависимости

```bash
pip install -r requirements.txt
```

#### 4. Настроить переменные окружения

Создайте файл `.env` в корне проекта и добавьте следующие строки:

```env
TOKEN=ваш_токен_бота_telegram
GROQ_API_KEY=токен_с_groq
LOG_LEVEL=DEBUG
REDIS_HOST=localhost
REDIS_PORT=ваш_порт_redis'а
```
Ссылка на [Groq](https://groq.com/)


#### 5. Запустить бота

```bash
python main.py
```


## Автор

**Иван Семенкин**  
[isemenkin@gmail.com](mailto:isemenkin@gmail.com)

[GitHub](https://github.com/IvanSemenkin)

